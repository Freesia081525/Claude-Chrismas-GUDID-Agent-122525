這是一份經過深度整合、重組與潤飾的技術規格書。本文件將您提供的「軟體需求規格書(SRS)範本」、「GUDID 資料品質改善深度報告」以及「TFDA 試辦與 Sandbox PoC 計畫構想」融合成一份完整的 **《食品藥物管理署 AI 人工智慧技術應用於醫療器材單一識別系統資訊平台 (TUDID) 與上市後資訊整合系統技術規格書》**。

文件字數約 3,500 字，包含 10 個詳細表格，並於文末附上 20 個針對 TFDA 情境的深度追問。

---

# 食品藥物管理署 AI 人工智慧技術應用於醫療器材單一識別系統資訊平台 (TUDID) 與上市後資訊整合系統技術規格書

**文件版本：** v1.0 (草案)
**日期：** 2025年12月
**專案代號：** TFDA-AI-TUDID-2025
**機密等級：** 限閱 (Internal Use Only)

---

## 1. 專案概述 (Project Overview)

### 1.1 背景與目的
食品藥物管理署 (TFDA) 為強化國內醫療器材全生命週期管理，已建置「醫療器材單一識別系統資訊平台」(TUDID)。然而，隨著資料量的指數級增長及國際法規（如美國 FDA GUDID、歐盟 EUDAMED）的演進，現行系統面臨資料完整性不足（必填欄位遺漏率約 15-25%）、跨欄位邏輯衝突、以及人工審核效率瓶頸等挑戰。

本計畫旨在導入「多代理 AI (Multi-Agent AI)」與「知識圖譜 (Knowledge Graph)」技術，建置一套智慧化輔助系統。透過為期一年的「沙盒試辦計畫 (Sandbox PoC)」，在不影響正式環境的前提下，驗證 AI 於資料清洗、異常偵測、自動編碼及風險預警的效能，最終目標是建立符合國際標準（HL7 FHIR、IMDRF）且具備高度自動化的監管科技 (RegTech) 平台。

### 1.2 系統核心價值
本系統將從傳統的「被動式資料庫」轉型為「主動式智能平台」，核心價值包括：
1.  **資料品質自動化治理**：透過 AI 代理人自動執行六大維度（完整性、準確性、一致性、時效性、有效性、唯一性）的檢核。
2.  **監管效率提升**：利用 NLP 技術自動比對仿單文件與登錄資料，減少人工重複查核時間。
3.  **上市後風險預警**：結合不良事件通報與回收資訊，利用因果推論模型識別潛在的高風險器材。
4.  **國際接軌**：實現 TUDID 與 GMDN、EUDAMED 等國際標準的語義互通。

---

## 2. 系統架構設計 (System Architecture)

### 2.1 整體架構概念
系統採用 **微服務 (Microservices)** 搭配 **多代理系統 (Multi-Agent System, MAS)** 架構。底層依託於政府雲 (T-Cloud) 或混合雲環境，透過事件驅動 (Event-Driven) 機制處理大規模數據流。

### 2.2 核心組件說明
1.  **主控代理 (Master Agent)**：負責任務編排、優先級管理與代理人間的協作。
2.  **功能性代理群 (Functional Agents)**：包含約 31 個專職代理，如結構檢核、邏輯一致性、風險評分、法規遵循等。
3.  **知識圖譜層 (Knowledge Graph Layer)**：利用 Graph DB 儲存器材、廠商、原料、不良事件之間的複雜關聯，支援深度的關聯分析。
4.  **大型語言模型整合層 (LLM Integration Layer)**：透過統一介面 (Call_LLM) 整合 OpenAI、Gemini 或本地端 Llama 模型，處理非結構化文本。

**表 1：系統核心組件與技術堆疊**

| 層級 | 核心組件 | 建議技術/工具 | 功能描述 |
| :--- | :--- | :--- | :--- |
| **展示層** | Web UI / Dashboard | Streamlit, React, Apache ECharts | 支援 RWD、多語系 (繁/英)、WOW UI 畫家主題風格 |
| **應用層** | API Gateway | FastAPI, Kong | RESTful API 管理、OAuth 2.0 認證、流量限制 |
| **代理層** | Multi-Agent Framework | LangChain, AutoGen | 代理協作、任務分派、記憶管理 (Memory) |
| **模型層** | ML/DL Models | PyTorch, XGBoost, BioBERT | 實體識別 (NER)、異常檢測、分類預測 |
| **知識層** | Knowledge Graph | Neo4j, RDF Triple Store | 儲存實體關係 (Device-Manufacturer-Event) |
| **資料層** | Data Storage | PostgreSQL (Partman), MongoDB, S3 | 結構化資料、文件資料、資料湖 (Data Lake) |
| **串流層** | Stream Processing | Apache Kafka, Flink | 即時資料攝取、非同步任務處理 |
| **基礎設施** | DevOps & SecOps | Kubernetes, Docker, Vault | 容器編排、金鑰管理、CI/CD 流水線 |

---

## 3. 功能性需求規格 (Functional Requirements)

本系統涵蓋十大核心應用案例，並針對 TFDA 監管需求進行深化設計。

### 3.1 共通功能需求
*   **使用者介面**：提供直覺式儀表板，支援「畫家風格主題」(如 Monet, Van Gogh) 切換，提升使用者體驗。
*   **AI 筆記小幫手**：在審查過程中，自動彙整法規檢查清單、生成議題洞見卡片，並將審查歷程轉化為結構化紀錄。
*   **資料匯入與處理**：支援 TUDID 格式 CSV/XML 批次匯入，以及 API 即時資料介接。

### 3.2 十大核心應用案例詳細規格

**表 2：十大核心應用案例功能對照表**

| 編號 | 應用案例名稱 | 核心功能描述 | 關鍵 AI 技術 | 預期效益 |
| :--- | :--- | :--- | :--- | :--- |
| **UC-01** | **NLP 智能分析** | 解析仿單、技術文件，自動提取器材特徵並比對 TUDID 欄位 | BioBERT, NER (Named Entity Recognition) | 減少 80% 文件比對時間 |
| **UC-02** | **異常資料偵測** | 識別數值異常 (如重量負值)、邏輯錯誤 (滅菌方式矛盾) | Isolation Forest, Autoencoder | 提升資料準確率至 99% |
| **UC-03** | **重複資料檢測** | 識別跨批次申請的重複器材或重複廠商紀錄 | MinHash, LSH, Siamese Network | 消除資料庫冗餘 |
| **UC-04** | **標籤資訊比對** | OCR 識別器材外盒標籤，比對 UDI、效期與資料庫一致性 | AWS Textract / EasyOCR, CNN | 確保標示合規性 |
| **UC-05** | **資料標準化** | 自動映射廠商名稱、地址格式、計量單位至標準格式 | Rule Engine, Fuzzy Matching | 資料一致性標準化 |
| **UC-06** | **不良事件連結** | 分析不良事件描述，推論因果關係並關聯至特定器材型號 | Causal Inference, Knowledge Graph | 縮短風險識別時間 |
| **UC-07** | **回收追蹤管理** | 自動化通知分銷鏈，追蹤回收進度與狀態 | Workflow Engine, Predictive Modeling | 提升回收回應率 |
| **UC-08** | **eIFU 電子說明書** | 透過 QR Code 提供最新版本說明書，支援離線存取 (PWA) | CDN, Version Control | 資訊即時更新與無紙化 |
| **UC-09** | **海關智能查驗** | 輔助海關識別 HS Code，即時評估進口器材風險 | Classification Models (XGBoost) | 加速通關與精準查驗 |
| **UC-10** | **國際資料庫連結** | 與 GMDN、EUDAMED 進行術語映射與資料同步 | Semantic Mapping, Sentence-BERT | 國際監管一致性 |

---

## 4. AI 智能代理與演算法規格 (AI Specs)

### 4.1 多代理系統設計 (Multi-Agent System)
系統將複雜的審查任務拆解為多個專職代理，由主控代理依據 `agents.yaml` 配置檔動態調度。

**表 3：AI 智能代理 (Agents) 職責定義表**

| 代理名稱 (Agent Name) | 職責描述 | 輸入資料 | 輸出產物 (JSON) |
| :--- | :--- | :--- | :--- |
| **Completeness Agent** | 檢查必填與建議欄位的填寫率 | TUDID 原始記錄 | 缺失欄位清單、完整性評分 |
| **Consistency Agent** | 驗證跨欄位邏輯 (如上市日 < 製造日) | TUDID 原始記錄 + 規則庫 | 邏輯衝突報告、修正建議 |
| **Regulation Agent** | 依據《醫療器材管理法》檢查合規性 | 產品描述 + 法規條文庫 | 合規性檢查清單、違規風險 |
| **Vocabulary Agent** | 檢查術語是否符合 GMDN/SNOMED 標準 | 產品名稱、預期用途 | 標準術語建議、映射信心度 |
| **Risk Scoring Agent** | 綜合各代理結果計算總體風險分 | 各代理輸出報告 | Risk Score (0-100)、高風險標記 |
| **Translation Agent** | 處理多語系欄位翻譯與校對 | 中/英產品描述 | 翻譯對照表、語意差異警示 |

### 4.2 機器學習模型配置
為確保高準確率與效能，針對不同資料類型採用最佳化模型。

**表 4：機器學習模型與演算法配置表**

| 應用場景 | 模型/演算法 | 技術細節 | 效能指標 (KPI) |
| :--- | :--- | :--- | :--- |
| **缺失值預測** | XGBoost / LightGBM | 利用相關欄位 (如廠商、類別) 預測缺失屬性 | Accuracy > 92% |
| **異常偵測** | Isolation Forest | 設定汙染率 (Contamination) 為 0.05，識別離群值 | Recall > 90% |
| **文本標準化** | BioBERT (Fine-tuned) | 針對醫療器材術語微調，進行實體識別與標準化 | F1-Score > 85% |
| **重複檢測** | MinHash + LSH | 處理百萬級資料的快速相似度比對 (Threshold > 0.85) | Precision > 95% |
| **GMDN 推薦** | Sentence-BERT | 計算產品描述與 GMDN 定義的語意相似度 | Top-3 Accuracy > 88% |
| **因果推論** | Bayesian Network | 建構器材故障與病患傷害之間的機率模型 | AUC > 0.80 |

### 4.3 知識圖譜應用 (Knowledge Graph)
使用 Neo4j 構建圖資料庫，實體包含 `(Device)`, `(Manufacturer)`, `(Material)`, `(Event)`。
*   **查詢範例 (Cypher)**：
    ```cypher
    MATCH (d:Device)-[:HAS_RISK]->(r:Recall)
    WHERE r.reason CONTAINS 'Battery'
    RETURN d.model, d.manufacturer
    ```
*   **用途**：支援供應鏈追溯、同材質器材風險擴散分析。

---

## 5. 資料治理與品質維度 (Data Governance)

本系統依據六大資料品質維度進行評分與治理，確保 TUDID 資料具備「可信賴性」。

**表 5：資料品質六大維度檢核標準表**

| 維度 (Dimension) | 定義 | 檢核邏輯範例 | 改善機制 |
| :--- | :--- | :--- | :--- |
| **完整性 (Completeness)** | 資料無缺漏 | 必填欄位不得為 Null；選填欄位依類別檢查 | 觸發補全代理，預測建議值 |
| **準確性 (Accuracy)** | 資料反映真實情況 | 與 FDA GUDID 或廠商 ERP 資料交叉比對 | 標記信心分數，人工覆核 |
| **一致性 (Consistency)** | 跨系統/欄位無矛盾 | 滅菌方式與無菌包裝標示一致 | 顯示邏輯衝突路徑 |
| **時效性 (Timeliness)** | 資料保持最新 | 上市狀態更新延遲 < 24 小時 | 設定過期資料定期掃描 |
| **有效性 (Validity)** | 符合格式與標準 | UDI 格式符合 GS1/HIBCC 規則 (Regex) | 自動格式清洗 (Trim/Format) |
| **唯一性 (Uniqueness)** | 無重複紀錄 | 相同 UDI-DI 不得重複登錄 | 去重演算法合併紀錄 |

---

## 6. 非功能性需求 (Non-Functional Requirements)

### 6.1 效能與 SLA
系統需滿足高併發與低延遲需求，特別是在海關查驗與大量批次上傳場景。

**表 6：系統效能與 SLA 指標表**

| 指標項目 | 需求規格 | 備註 |
| :--- | :--- | :--- |
| **即時查詢回應** | < 2 秒 (P95) | 針對單筆 UDI 查詢 |
| **複雜分析回應** | < 10 秒 | 針對風險評分或圖譜查詢 |
| **批次處理吞吐量** | > 10,000 筆/分鐘 | 支援 Kafka 非同步處理 |
| **系統可用性** | > 99.5% | 允許年度停機 < 43.8 小時 |
| **災難復原 (RTO)** | < 4 小時 | 異地備援啟動時間 |
| **資料復原點 (RPO)** | < 1 小時 | 資料遺失容忍度 |

### 6.2 資安與合規性 (TFDA Specific)
考量政府機關資安規範及醫療器材法規要求。

**表 7：資安防護與合規性控制矩陣**

| 控制領域 | 實施措施 | 技術規格 |
| :--- | :--- | :--- |
| **身分認證** | 多因素認證 (MFA) | 整合政府公鑰基礎建設 (GPKI) 或 OAuth 2.0 |
| **存取控制** | 最小權限原則 | RBAC (Role-Based) + ABAC (Attribute-Based) |
| **資料隱私** | 去識別化 (De-identification) | 針對病患資料進行 PHI 偵測與遮罩 (HIPAA 標準) |
| **電子簽章** | 不可否認性 | 符合 21 CFR Part 11 標準，記錄完整 Audit Trail |
| **網路安全** | 零信任架構 (Zero Trust) | mTLS 服務間加密，WAF 防禦，定期滲透測試 |
| **AI 安全** | 模型防禦 | 防止對抗式攻擊 (Adversarial Attacks) 與資料毒化 |

---

## 7. 系統介面與整合 (Interfaces)

### 7.1 外部系統介面
本系統需作為資料樞紐，連接內部與外部多個關鍵系統。

**表 8：外部系統介面整合規格表**

| 外部系統 | 介面類型 | 資料流向 | 資料內容與標準 |
| :--- | :--- | :--- | :--- |
| **TUDID 核心資料庫** | Database Link / API | 雙向 | 醫材主檔資料 (Sync/Async) |
| **關港貿單一窗口** | RESTful API | 輸出 | HS Code 建議、風險評級 (JSON) |
| **不良事件通報系統** | ETL / Stream | 輸入 | 通報案例資料 (HL7 FHIR) |
| **FDA AccessGUDID** | RESTful API | 輸入 | 美國上市醫材比對資料 |
| **EUDAMED (歐盟)** | XML/API | 輸入 | 歐盟上市醫材資料 |
| **醫療機構 HIS** | FHIR API | 雙向 | 院內使用紀錄、電子說明書存取 |

---

## 8. 基礎設施與試辦計畫 (Implementation Roadmap)

### 8.1 部署環境 (Sandbox & Production)
*   **Sandbox (試辦環境)**：部署於 TFDA 測試區或政府雲隔離區，僅使用匿名化或模擬資料。
*   **Production (正式環境)**：未來部署於政府雲 (T-Cloud)，具備 Auto-scaling 與高可用性配置。

### 8.2 一年期試辦計畫時程 (Sandbox PoC)
本計畫分為五個階段，旨在驗證技術可行性並收集產業回饋。

**表 9：試辦計畫 (Sandbox PoC) 階段時程表**

| 階段 | 時間 | 工作重點 | 交付產出 |
| :--- | :--- | :--- | :--- |
| **Phase 1** | 第 1-2 月 | **需求規劃與設計**：確認 TFDA 試辦範圍、資安檢視、法規盤點 | 需求規格書、資安評估報告 |
| **Phase 2** | 第 3-5 月 | **Sandbox 開發與測試**：實作初版多代理系統，建立模擬資料集 | Sandbox v1.0、核心代理 (15個) |
| **Phase 3** | 第 6-8 月 | **內部試用與擴充**：TFDA 內部人員試用，擴充至 31 個代理 | 代理擴充包、內部試用報告 |
| **Phase 4** | 第 9-11 月 | **產業協作試辦**：邀請業者/醫院參與，上傳測試資料，舉辦說明會 | 產業回饋報告、操作手冊 |
| **Phase 5** | 第 12 月 | **評估與總結**：效益評估、制定正式導入路線圖 | 總結報告、正式系統規劃書 |

---

## 9. 關鍵績效指標 (KPIs)

為確保專案效益可量化，設定以下 KPI 指標。

**表 10：關鍵績效指標 (KPI) 與預期效益表**

| 構面 | 指標名稱 (KPI) | 現況基準 (Baseline) | 目標值 (Target) |
| :--- | :--- | :--- | :--- |
| **資料品質** | 完整性評分 (Completeness) | 82% | > 95% |
| | 準確性評分 (Accuracy) | 90% | > 98% |
| **作業效率** | 單件審查平均時間 | 4 小時 | < 1 小時 |
| | 資料糾紛/修正案件數 | 120 件/年 | < 20 件/年 |
| **風險管理** | 召回事件響應時間 | 48 小時 | < 6 小時 |
| **系統效能** | 自動化處理率 | 0% (全人工) | > 85% |
| **使用者滿意度** | 系統易用性評分 (SUS) | N/A | > 80 分 |

---

## 10. 附錄：20 個綜合後續問題 (Comprehensive Follow-up Questions)

為確保專案執行的深度與廣度，以下針對技術、法規、資安與未來發展提出關鍵問題：

### 技術實作類
1.  **AI 幻覺控制**：當 LLM 針對仿單內容進行摘要時，如何防止產生與事實不符的「幻覺 (Hallucination)」，並確保監管決策的證據力？
2.  **知識圖譜維護**：當器材規格變更頻繁時，Neo4j 圖資料庫的更新策略為何？如何處理舊版本與新版本之間的關聯斷裂？
3.  **代理人衝突解決**：若「法規代理人」與「術語代理人」對同一欄位的建議產生衝突（例如法規要求中文名稱但術語建議英文通用名），主控代理的仲裁邏輯為何？
4.  **模型漂移 (Drift)**：針對海關查驗的 XGBoost 模型，如何設計自動化的 Retraining Pipeline 以應對新的走私手法或新興器材？
5.  **冷啟動問題**：對於全新上市、無歷史數據的創新醫材，異常偵測模型如何避免高誤報率？

### 法規與合規類
6.  **AI 決策責任**：若系統建議「通過」但事後發生嚴重不良事件，AI 系統供應商、TFDA 與審查人員之間的責任歸屬如何界定？
7.  **電子簽章整合**：在多代理系統自動修正資料的情況下，如何在 21 CFR Part 11 的框架下記錄「機器修改」的審計軌跡？
8.  **匿名化合規**：在 Sandbox 階段使用真實資料進行測試時，如何確保符合《個人資料保護法》及 TFDA 內部資料管理規定？
9.  **國際法規同步**：若 EUDAMED 更新了 UDI 資料結構，本系統的欄位映射規則能在多短時間內完成適配？

### 資安與架構類
10. **政府雲限制**：若政府雲 (T-Cloud) 對於 GPU 資源或外部 API (如 OpenAI) 存取有嚴格限制，備選的地端模型 (Local LLM) 方案為何？
11. **供應鏈攻擊**：如何確保開源的 AI 框架 (如 LangChain) 或 Docker Image 不含惡意程式碼？
12. **多租戶隔離**：在產業試辦階段，如何確保 A 廠商無法透過 Prompt Injection 等攻擊手段窺探 B 廠商的測試資料？

### 資料治理類
13. **資料擁有權**：經過 AI 清洗與補全後的資料，其智慧財產權歸屬於 TFDA 還是原始資料提供者？
14. **GMDN 授權**：系統自動推薦 GMDN 代碼是否涉及版權授權問題？如何處理付費代碼庫的串接？
15. **歷史資料清洗**：針對 TUDID 既有的數十萬筆舊資料，採取的清洗策略是「一次性大清洗」還是「變更時觸發清洗」？

### 未來發展與推廣類
16. **業者自檢工具**：未來是否計畫將部分 AI 代理功能開放給業者，作為申報前的「自我預審」工具？
17. **商業模式**：若開放給醫院或業者使用進階分析功能，是否考慮收費模式以支撐系統維運成本？
18. **跨機關整合**：本系統是否能進一步與健保署的醫材比價網或給付系統串接，實現「登錄-給付」一條龍？
19. **國際輸出**：這套 RegTech 解決方案是否具備輸出至其他國家（如東南亞監管機關）的潛力？
20. **人才培訓**：TFDA 內部審查人員需具備何種程度的 AI 知識才能有效操作此系統？是否需規劃專門的轉型培訓課程？

---
*(文件結束)*
